<!DOCTYPE html>
<html lang="en">

{% block head %}
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <link rel="icon" href="#">

    <title>Gutenberg Books</title>
    <!--http://tympanus.net/codrops/2011/11/28/typography-effects-with-css3-and-jquery/ -->
    {% load staticfiles %}

    {% block styles %}
    <!-- Bootstrap core CSS -->
    <link href="{% static 'BooksApp/css/bootstrap.min.css' %}" rel="stylesheet">
    <link href="{% static 'BooksApp/css/custom.css' %}" rel="stylesheet">
    <link href='http://fonts.googleapis.com/css?family=Lobster' rel='stylesheet' type='text/css'>
    <style>





    </style>
    {% endblock %}

</head>
{% endblock %}

{% block body %}
<body>
<div class="container">
    <h1 class="lead">
        Public Domain Book Analysis
    </h1>
    <h2 class="headline">Dramatis Personae</h2>
    <div class="row">
        <div class="col-md-4">
            <div class="panel panel-default" id="alice">
                <div class="panel-body">
                    <p class="book_title text-center">
                        Alice in Wonderland
                    </p>
                    <a href="http://www.gutenberg.org/ebooks/11" class="source">Source: Project Gutenberg</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="panel panel-default" id="dracula">
                <div class="panel-body">
                    <p class="book_title text-center">
                        Dracula
                    </p>
                    <a href="http://www.gutenberg.org/ebooks/345" class="source">Source: Project Gutenberg</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p class="book_title text-center">
                        Moby Dick
                    </p>
                    <a href="http://www.gutenberg.org/ebooks/2701" class="source">Source: Project Gutenberg</a>
                </div>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="col-md-4 col-md-offset-2">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p class="book_title text-center">
                        Pride and Prejudice
                    </p>
                    <a href="http://www.gutenberg.org/ebooks/42671" class="source">Source: Project Gutenberg</a>
                </div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="panel panel-default">
                <div class="panel-body">
                    <p class="book_title text-center">
                        A Tale of Two Cities
                    </p>
                    <a href="http://www.gutenberg.org/ebooks/98" class="source">Source: Project Gutenberg</a>
                </div>
            </div>
        </div>
    </div>


    <h1>LONGEST COMMON SENTENCES</h1>
    <div id="wordCloud" class="chart"></div>
        <div id="donut_Moby" class="chart"></div>
        <div id="donut_TwoCities" class="chart"></div>
    <div class="col-md-12">
        <div id="stackedbar" class="chart"></div>
    </div>
</div>
</body>
{% endblock %}

{% block footer %}
<footer>
</footer>
{% endblock %}


{% block scripts %}
<script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js" charset="utf-8"></script>
<script src="{% static 'BooksApp/js/bootstrap.min.js' %}"></script>
<script src="{% static 'BooksApp/js/d3.layout.cloud.js' %}"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="{% static 'BooksApp/js/ie10-viewport-bug-workaround.js' %}"></script>
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>


<script>
//Dracula Word Cloud

var fill = d3.scale.category20();

//var fill = d3.scale.ordinal().range(['#000000', '#4D4D4D', '#808080', '#B20000', '#FF0000']).domain(d3.range(0,6))

randomRotate=d3.scale.linear().domain([0,1]).range([-75,75]);

d3.csv( "{% static 'BooksApp/csv/'|add:csv_file %}", function(d) {
        return {
          text: d.word,
          size: +d.frequency/6
        }
      },
      function(data) {
        d3.layout.cloud().size([1000, 600]).words(
          data
          )
          .rotate(function() {return randomRotate(Math.random())})
          .font("Impact")
          .fontSize(function(d) {
            return d.size;
          })
          .on("end", draw)
          .start();

        function draw(words) {

          console.log(words);
          d3.select("#wordCloud").append("svg")
            .attr("width", 1000)
            .attr("height", 600)
            .append("g")
            .attr("transform", "translate(500,300)")
            .selectAll("text")
            .data(words)
            .enter().append("text")
            .style("font-size", function(d) {
              return d.size + "px";
            })
            .style("font-family", "Impact")
            .style("align", "center")
            .style("fill", function(d, i) {
              return fill(i);
            })
            .attr("text-anchor", "middle")
            .attr("transform", function(d) {
              return "translate(" + [d.x, d.y] + ")rotate(" + d.rotate + ")";
            })
            .text(function(d) {
              return d.text;
            });
        }
      });

</script>
<script>
    //Half donut chart - Moby Dick
    $(function () {
    $('#donut_Moby').highcharts({
        chart: {
        backgroundColor: "rgba(255, 255, 255, 0)",
            plotBackgroundColor: null,
            plotBorderWidth: 0,
            plotShadow: false
        },
        title: {
            text: 'Moby Dick<br>Pronoun<br>Breakdown',
            align: 'center',
            verticalAlign: 'middle',
            y: 40
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
        },
        plotOptions: {
            pie: {
                dataLabels: {
                    enabled: true,
                    distance: -50,
                    style: {
                        fontWeight: 'bold',
                        color: 'white',
                        textShadow: '0px 1px 2px black'
                    }
                },
                startAngle: -90,
                endAngle: 90,
                center: ['50%', '75%']
            }
        },
        series: [{
            type: 'pie',
            name: 'Frequency',
            innerSize: '50%',
            data: [
                {
                    name: 'Not Dick',
                    y: {{ f_count_moby_dick }},
                    color: '#FF9900'
                },
                {
                name: 'Dick',
                y: {{ m_count_moby_dick }},
                color: '#0066FF'
                },

            ]
        }]
    });
});

</script>
<script>
    //Half donut chart - TwoCities
    $(function () {
    $('#donut_TwoCities').highcharts({
        chart: {
            backgroundColor: "rgba(255, 255, 255, 0)",
            plotBackgroundColor: null,
            plotBorderWidth: 0,
            plotShadow: false
        },
        title: {
            text: 'A Tale of<br>Two Cities<br>Pronoun Breakdown',
            align: 'center',
            verticalAlign: 'middle',
            y: 40
        },
        tooltip: {
            pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
        },
        plotOptions: {
            pie: {
                dataLabels: {
                    enabled: true,
                    distance: -50,
                    style: {
                        fontWeight: 'bold',
                        color: 'white',
                        textShadow: '0px 1px 2px black'
                    }
                },
                startAngle: -90,
                endAngle: 90,
                center: ['50%', '75%']
            }
        },
        series: [{
            type: 'pie',
            name: 'Frequency',
            innerSize: '50%',
            data: [
                {
                    name: 'Ladies',
                    y: {{ f_count_twocities }},
                    color: '#FF9900'
                },
                {
                    name: 'Gents',
                    y: {{ m_count_twocities }},
                    color: '#0066FF'
                },

            ]
        }]
    });
});

</script>
<script>
    //Stacked Bar Chart
$(function () {
    $('#stackedbar').highcharts({

        chart: {
            type: 'column',
            backgroundColor: "rgba(255, 255, 255, 0)",
        },

        title: {
            text: 'Pronoun Frequency Grouped by Gender'
        },

        xAxis: {
            categories: ['Alice in Wonderland', 'Dracula', 'Moby Dick', 'Pride and Prejudice', 'A Tale of Two Cities']
        },

        yAxis: {
            allowDecimals: false,
            min: 0,
            title: {
                text: 'Word Frequency'
            }
        },

        tooltip: {
            formatter: function () {
                return '<b>' + this.x + '</b><br/>' +
                    this.series.name + ': ' + this.y + '<br/>' +
                    'Total: ' + this.point.stackTotal;
            }
        },

        plotOptions: {
            column: {
                stacking: 'normal'
            }
        },

        series: [{
            name: 'Her',
            data: {{ her_counts }},
            stack: 'female',
            color: '#290052'
        }, {
            name: 'She',
            data: {{ she_counts }},
            stack: 'female',
            color: '#5200A3'
        }, {
            name: 'Hers',
            data: {{ hers_counts }},
            stack: 'female',
            color: '#944DDB'
        }, {
            name: 'Herself',
            data: {{ herself_counts }},
            stack: 'female',
            color: '#D1B2F0'
        }, {
            name: 'He',
            data: {{ he_counts }},
            stack: 'male',
            color: '#520000'
        }, {
            name: 'Him',
            data: {{ him_counts }},
            stack: 'male',
            color: '#8F0000'
        }, {
            name: 'His',
            data: {{ his_counts }},
            stack: 'male',
            color: '#CC0000'
        }, {
            name: 'Himself',
            data: {{ himself_counts }},
            stack: 'male',
            color: '#DB4D4D'
        }]
    });
});
</script>

{% endblock %}

</html>
